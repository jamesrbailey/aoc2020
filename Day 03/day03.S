# AOC2020 Day 3 Part 1 & 2 in RISC-V assembly
# Assembled and running on the Venus instruction set simulator
# J.Bailey

main:

    la s0,input_start
    li s1,0   # number of trees encountered
    li s2,0   # current x
    li s3,0   # current y
    li s4,3   # x-step
    li s5,1   # y-step
    li s6,31  # number of columns (max x)
    li s7,323 # number of lines (max y)
    li a6,32  # column address stride
    li t6,35  # tree character

# t0 - memory address of interest
# t1 - character of interest
loop:
    mul    t0,s3,a6 # compute mem address of x,y
    add    t0,t0,s2
    add    t0,t0,s0
    lb     t1,0(t0)
    bne    t1,t6,post_inc
    addi   s1,s1,1
post_inc:
    add    s2,s2,s4
    blt    s2,s6,post_mod 
    sub    s2,s2,s6 # fake modulus :)
post_mod:
    add    s3,s3,s5
    blt    s3,s7,loop


report:
    li     a0,1
    mv     a1,s1
    ecall
    

.data
input_start:
    .asciiz "............#....#............."
    .asciiz "...........##....#......#..#..#"
    .asciiz "......#.......#......#........."
    .asciiz "..#.#....#....#.............##."
    .asciiz "..#........####....#...#......."
    .asciiz "..##.....#.#.#..#.........#...."
    .asciiz "...#.#..#..#....#..#..#........"
    .asciiz "#.......#.........#....##.###.."
    .asciiz "......##..#.#...#.......#.#...."
    .asciiz "................##.........#.##"
    .asciiz "..##..........#...#.........#.#"
    .asciiz "..........#...##..............."
    .asciiz "#...#......#..#.#..#...##..#..."
    .asciiz "..##....#.......#......#..#...."
    .asciiz "....#......#......#....#......."
    .asciiz ".........#.....#..#............"
    .asciiz ".#...#.#.........#........#...."
    .asciiz "#..........####.....#.........."
    .asciiz "......##.....#....#..#........#"
    .asciiz "#......#......#...........#...."
    .asciiz "....#.........#....#...#..#..#."
    .asciiz ".#........#......#.#.....#....."
    .asciiz "..#.#.#..........#....#.......#"
    .asciiz "......#.#........##....##....##"
    .asciiz ".....#.#..#...#................"
    .asciiz "......#......##...............#"
    .asciiz "..#..##.............#...##....."
    .asciiz "......##......##..#......#....."
    .asciiz "....#.............#..##.....##."
    .asciiz "........#...............##....."
    .asciiz "..#......#.##..#...#....#...#.."
    .asciiz "#......#.......#.............#."
    .asciiz ".....#....##..............#...."
    .asciiz "#.#.........#....#..##....#...."
    .asciiz ".#...#...#....#.#............#."
    .asciiz "...#...#.#..##.##.......##....."
    .asciiz "......#..#....##..#.#..#..#...."
    .asciiz ".......##..#..#......#..#.....#"
    .asciiz ".##..#......#..........#....#.."
    .asciiz ".....#................#..#....#"
    .asciiz "........#..#....#.......#....#."
    .asciiz "..#......#.......#......#....#."
    .asciiz "....#...#.##........##....#...."
    .asciiz ".....#........#...........#...."
    .asciiz "...#....##..........#..#...#.#."
    .asciiz "...#.......#......#...##...#..."
    .asciiz ".#.....#........#........#.#..#"
    .asciiz ".#.........#..##.....#.......#."
    .asciiz "....#..#....#.......#......#..."
    .asciiz ".#.#...##..##................##"
    .asciiz "......#.#...#.......#....#....#"
    .asciiz "........#....#..#.....#......#."
    .asciiz ".......#..........#......#....."
    .asciiz "..............................."
    .asciiz "..#..#####..#..#..........#.#.."
    .asciiz ".....#....##................#.#"
    .asciiz ".................##............"
    .asciiz ".#...#...#..#...........#...##."
    .asciiz "..#..#.#...........#.....##...."
    .asciiz ".#.......#.....#..##..#.#....#."
    .asciiz "..........#.#......##...##....."
    .asciiz "........##..#......##...#......"
    .asciiz "#......................#......."
    .asciiz "............#.....#....#.#...#."
    .asciiz "#......#..........##..#........"
    .asciiz ".........#.......#...#.#......."
    .asciiz "...........##....#........#...."
    .asciiz "#........#.....#...#........##."
    .asciiz ".#......##......#.##.......#..#"
    .asciiz ".....#......#.#......#.......#."
    .asciiz ".....#.#.........#............."
    .asciiz "...........#..#....#.....#.#..."
    .asciiz "...#............#...#.........."
    .asciiz "..#..#...#....................."
    .asciiz "......#..#...#....#............"
    .asciiz ".#.#.#........#..#...#........."
    .asciiz "..........#........#..#........"
    .asciiz "..............#...#....#......."
    .asciiz "..#....#....##.......#...#.##.."
    .asciiz ".#.........#...#......#........"
    .asciiz "..#......#...#.........##.#...#"
    .asciiz "...#.....#...#..#.............#"
    .asciiz ".##........#.#.#.............#."
    .asciiz "..#.............#..#.#...#....#"
    .asciiz "#...#.........#......#......#.."
    .asciiz ".......##..#.#..........#...#.."
    .asciiz ".......#.............#..#.#...."
    .asciiz ".#..#....#.#..................."
    .asciiz "....##...#..#....#..#.........."
    .asciiz "....#.#............#..........."
    .asciiz "###........##..#.#..#.........."
    .asciiz ".#.#.#.......#...........#..#.#"
    .asciiz "..........##..#.............#.."
    .asciiz ".#...........#......#.#..#..##."
    .asciiz "...###......#.##........#.....#"
    .asciiz "....#..#..#...#................"
    .asciiz "...#.....#........#............"
    .asciiz "....#...#...#..#..##.##.......#"
    .asciiz "#.......#......#....#.......#.."
    .asciiz "#.............#...#............"
    .asciiz "##......#..#...#....##.#...#..."
    .asciiz ".##....................#....#.."
    .asciiz "..#.....#....#.#....#......#..."
    .asciiz ".......#..#..#............#...#"
    .asciiz ".#.....#.......#..#..#..#......"
    .asciiz "......##......................."
    .asciiz "#..#...#.#.#....#.....#..#....."
    .asciiz "...................#...#...#..."
    .asciiz "........#....##..#....#........"
    .asciiz "##......#.#......##.###........"
    .asciiz ".........#...##................"
    .asciiz ".......#...#...#.......##......"
    .asciiz "....#.......#......#.........##"
    .asciiz "....#....#.#..#.....#.........."
    .asciiz "...........#.......#........#.."
    .asciiz "..#.........###.#........#....."
    .asciiz ".......#...........#.#.....##.."
    .asciiz "..#...#..#..........#.........."
    .asciiz "..........#.#....#............."
    .asciiz ".##....#........##............."
    .asciiz ".............#.#####........#.#"
    .asciiz ".................##...#........"
    .asciiz "##...#.#.......##........#....."
    .asciiz ".#...#...#..#..#....#....#....."
    .asciiz "..#...#........#..#............"
    .asciiz "##...#.#........#......##.#..##"
    .asciiz ".##......#..............##.#..#"
    .asciiz ".........#...#............#...#"
    .asciiz "....#..#....#...........#......"
    .asciiz "........#..#....#...##...#....."
    .asciiz "..#..............#...#.#.....#."
    .asciiz ".#.......#.#.....#..###.......#"
    .asciiz "...................#.......#..."
    .asciiz "........##.....#..#.......##..."
    .asciiz ".....#....................#...#"
    .asciiz "...#.#....#............#.#....."
    .asciiz "#.......#.......#....#........."
    .asciiz "..#...............#............"
    .asciiz "##...#...#...#..............#.."
    .asciiz "...#..........#..#....##......."
    .asciiz "#............##.##......#.#.#.."
    .asciiz ".#...........#.........#....##."
    .asciiz "..##....##.#....#.#.#.##...##.#"
    .asciiz "........#.#.#.............#...."
    .asciiz ".#...........#....##...#...#.#."
    .asciiz ".##...#.................#......"
    .asciiz "....#.#..#....................#"
    .asciiz ".##......#........#..#........."
    .asciiz "...#...............#..........."
    .asciiz ".#.#..##..##.#........#........"
    .asciiz "...........#....#.#.#......#..."
    .asciiz "...................#........#.#"
    .asciiz "..#............#...#.#........#"
    .asciiz "....#....#.#.##......#...#....."
    .asciiz "..................#............"
    .asciiz "..........................#...."
    .asciiz "........#......................"
    .asciiz "......#.#...#.#..##......#.#.#."
    .asciiz ".........#...#..#.............."
    .asciiz "..#.......#..........##..#....."
    .asciiz ".........#............#........"
    .asciiz "......#..#..#...###....#....#.."
    .asciiz "#..#..............##.###..##..#"
    .asciiz ".#..................#.....#...#"
    .asciiz "........#........#........#...."
    .asciiz ".........#........#.##......#.."
    .asciiz "..#.....#.#..###...#....#......"
    .asciiz "..#................##....#....."
    .asciiz "..#.#....##.....#......##...#.."
    .asciiz "...#.......#........##........."
    .asciiz "#........#...#.#..........##..#"
    .asciiz "................#...#.#.....#.."
    .asciiz ".........#..#..#.#..#.#...#...."
    .asciiz "##....#...##.........#.#...#.##"
    .asciiz "....#..#.....##.....#.....##..."
    .asciiz "................#............#."
    .asciiz "..#..#...#.....#......#.....##."
    .asciiz "....#.......#...#...#...#..#..."
    .asciiz "....#..##....#.###.#...#..#...."
    .asciiz "#..##.....#.....#.##..##...##.#"
    .asciiz ".............###..........#...."
    .asciiz "..................#.....###...."
    .asciiz "..........#....#...#......#...."
    .asciiz "...#..##.......#......#.#...#.."
    .asciiz "..#.......................##.#."
    .asciiz "..#..#..#....#......#...#...##."
    .asciiz "#.............#................"
    .asciiz "..........#.#.#.........#.#...."
    .asciiz ".....##..#......##.#..........."
    .asciiz ".#.#.#.#....#.#...#.....#.#...#"
    .asciiz "......#.....##..............##."
    .asciiz "#..#.......##..##.............."
    .asciiz "#..#..#................###....."
    .asciiz ".....#......#.........#........"
    .asciiz "#...........#........#.#......."
    .asciiz "#........#.#...#....#....###..#"
    .asciiz "###..#.#...........#.##.....#.#"
    .asciiz "..#..........#..#............#."
    .asciiz "...#....#.......#..#.....###..."
    .asciiz ".#....#.##.#..###.............."
    .asciiz ".....#.##.##.......###.##...#.#"
    .asciiz "..#..##.......###.............."
    .asciiz ".#.........###..#.............."
    .asciiz "..................###.....#..#."
    .asciiz "#....#....#.........#.....#...."
    .asciiz ".........#.#..#....#.....#....."
    .asciiz "....##.......##.......#.#......"
    .asciiz ".....#...#.##.....#............"
    .asciiz "....#.#.#.......#.............."
    .asciiz ".##..#.#..#.......##..........."
    .asciiz "....#....##..#.....##.......#.#"
    .asciiz ".....##....#..#.#........#....."
    .asciiz "........#.#.#....#....##...#..#"
    .asciiz "..#......#.#.#..#.##....#.#.#.."
    .asciiz "..#...#........#..#..........#."
    .asciiz ".........#...................#."
    .asciiz "........#.....##..#....#....#.."
    .asciiz "#..............#..........#...."
    .asciiz "#........#.#...........#.#....."
    .asciiz "..#......................#.#..#"
    .asciiz ".........#.#.....#.#..........#"
    .asciiz "......#....#.#.##........#....."
    .asciiz ".#....##......##..#...#.......#"
    .asciiz "..#........#...#.##....#..#.#.."
    .asciiz ".......#.....#..........#.....#"
    .asciiz ".........#.#..#.........#....#."
    .asciiz "..........#.##.........##..#..."
    .asciiz "......#.#..#.....#.#..........#"
    .asciiz "......#.#.#..#..#.#............"
    .asciiz "...##.#..#..............#....#."
    .asciiz "#..........#..................."
    .asciiz ".#....#..#.#.......#........#.."
    .asciiz "...#...#......#....#......#...."
    .asciiz "..#.#.......#.......#.......#.#"
    .asciiz "...#.#...#........#.....#......"
    .asciiz "#.......#..#..................."
    .asciiz "#..#..#.............#..#..#..#."
    .asciiz "#.......................#....##"
    .asciiz ".#.........#....#....#........."
    .asciiz "...............#...#..#....#..#"
    .asciiz "#.....#.#...#.#.....#.........."
    .asciiz "....##.#..#...#.#....###...#.#."
    .asciiz ".................#....#........"
    .asciiz "####.......##...##.......#.##.."
    .asciiz "#..#....#....##............#..."
    .asciiz "..##......#..#........#........"
    .asciiz "....#..#..........#......#...##"
    .asciiz "..#.#.............#...........#"
    .asciiz "#...............#...#.......#.#"
    .asciiz "#..#.........#.##.#.......#...#"
    .asciiz "......#.....#.............#...#"
    .asciiz "......#.##.........##...#......"
    .asciiz "..#......##.#........#.......#."
    .asciiz "#..#.........#.##.............."
    .asciiz "..#....#...#...#..#.....#.#...."
    .asciiz "................#.......#......"
    .asciiz "#.....#..............##....#.##"
    .asciiz "##.....#...#.#.....#..##...#..."
    .asciiz "#.#............##..........#..#"
    .asciiz "..#.##......#..#....#.........."
    .asciiz "....##.#....#.......##.....#..."
    .asciiz "......#.#....###...#..........."
    .asciiz "..................#......#....#"
    .asciiz "..............##..............."
    .asciiz "......#..#....#.....#.........."
    .asciiz ".......#........#...#.........."
    .asciiz "..#......#......##..#.##..#...."
    .asciiz "..#.#...#...............#......"
    .asciiz "....#.#.............#.#......#."
    .asciiz "....#.#.....#......#..#.......#"
    .asciiz "........................#..#..."
    .asciiz ".................#...........#."
    .asciiz "#......#......#.#.#.....##....."
    .asciiz "..#....##...#.....##.#.....#..#"
    .asciiz "....#.........#....#.##.#.#...."
    .asciiz "..#....###....................."
    .asciiz ".....#.#....#......#....##....#"
    .asciiz "#.......#...#......##.......#.."
    .asciiz "#....#.........##.....#........"
    .asciiz "#.....#...........#..#.....#..."
    .asciiz ".................#.....#..##..#"
    .asciiz "..#...#......####...##........."
    .asciiz "..............................."
    .asciiz "#........#.....#..............."
    .asciiz ".#.........#....#.#......##...."
    .asciiz "...#..........#.........#.#.#.#"
    .asciiz "......##......#....###........#"
    .asciiz ".....................#.#.#....."
    .asciiz "......#..#..#.......#...#......"
    .asciiz "...##.#.............#.#.......#"
    .asciiz "..#.#...#..#....#.....#.....#.."
    .asciiz "..#..#.....................#..#"
    .asciiz "........#....#..........#..#..."
    .asciiz "#.##....#..#.#..#............#."
    .asciiz "..............###.............#"
    .asciiz ".#.#..........#.#....#...#....#"
    .asciiz "....#..........#.#..#......#..."
    .asciiz ".........##.#...#.............."
    .asciiz "..................#.....#.#...."
    .asciiz ".#....#.......#.##.#.........#."
    .asciiz ".##..#...#......#..#..........."
    .asciiz ".#.........#..........#.#......"
    .asciiz "#.#......#.#.#.#.......#...#.#."
    .asciiz ".......#....#.#......#......#.."
    .asciiz "...#..#....#.#..#..##...##....."
    .asciiz "#.#.#.......#....#.........##.."
    .asciiz "#..#....#........###....#.#...."
    .asciiz "....#..#.........#....#...#...."
    .asciiz "...#.#.#.#..#..##.....#.##....."
    .asciiz ".......#.......#..............."
    .asciiz "#.#.#......##....#............."
    .asciiz "...#.##........#.....#...##.#.."
    .asciiz "...#.#.###..........#.......#.."
    .asciiz ".....#...#.......#.........#..."
    .asciiz "............#..#...#..##......."
    .asciiz "...#....#..##.##..........#.##."
    .asciiz "..................#........#..."
    .asciiz "....#.##.#.##........#.#......."
    .asciiz ".#...........##.....##.......#."
    .asciiz "#...#.........#.....##........."
    .asciiz "#..#....#.#.........#.........."
    .asciiz "..#......#.#.#......#.....#..#."
    .asciiz "..##......#..............#....."
input_end: